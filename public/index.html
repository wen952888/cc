<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KK 在线纸牌</title>
    
    <!-- Favicon - 确保 public/images/favicon.ico 文件存在 -->
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">

    <!-- 建议将版本号与 package.json 和 client.js 中的 CLIENT_VERSION 统一 -->
    <link rel="stylesheet" href="style.css?v=1.1.0"> 
    <link rel="manifest" href="manifest.json">
    <!-- theme-color 应与 manifest.json 中的一致 -->
    <meta name="theme-color" content="#e0e0e0"/> 
    <link rel="apple-touch-icon" href="/images/icon-192x192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="KK纸牌">
</head>
<body>
    <!-- 加载视图: 初始显示，并在连接问题时显示 -->
    <div id="loadingView" class="view view-block"><p>连接中...</p></div>

    <!-- 认证视图: 登录和注册 -->
    <div id="loginRegisterView" class="view hidden-view">
        <h2>登录 / 注册</h2>
        <div id="authFormContainer">
            <div class="formSection">
                <h3>注册</h3>
                <input type="tel" id="regPhone" placeholder="手机号" autocomplete="username">
                <input type="password" id="regPassword" placeholder="密码 (至少4位)" autocomplete="new-password">
                <button id="registerButton">注册</button>
            </div>
            <div class="formSection">
                <h3>登录</h3>
                <input type="tel" id="loginPhone" placeholder="手机号" autocomplete="username">
                <input type="password" id="loginPassword" placeholder="密码" autocomplete="current-password">
                <button id="loginButton">登录</button>
            </div>
        </div>
        <p id="authMessage" class="message"></p>
    </div>

    <!-- 大厅视图: 创建或加入房间 -->
    <div id="lobbyView" class="view hidden-view">
        <h2>游戏大厅</h2>
        <p>欢迎, <span id="lobbyUsername">玩家</span>! <button id="logoutButton" class="inline-button">登出</button></p>
        <div id="createRoomSection">
            <h3>创建房间</h3>
            <input type="text" id="createRoomName" placeholder="房间名称 (1-10字符)" maxlength="10">
            <input type="password" id="createRoomPassword" placeholder="房间密码 (可选, 最多10字符)" maxlength="10">
            <button id="createRoomButton">创建</button>
        </div>
        <h3>加入房间</h3>
        <div id="roomList">
            <p>加载中...</p> <!-- 初始房间列表加载提示 -->
        </div>
        <p id="lobbyMessage" class="message"></p>
    </div>

    <!-- 游戏房间视图: 主要游戏界面 -->
    <div id="roomView" class="view hidden-view view-flex">
        <div id="gameArea">
            <!-- 顶部游戏信息栏 -->
            <div id="gameInfoBar">
                <div class="room-name-id">
                    <span class="room-name">房间名</span>
                    <span class="room-id">ID: ---</span>
                    <!-- 可以在这里加入当前回合玩家信息 -->
                </div>
                <button id="leaveRoomButton">离开房间</button>
            </div>

            <!-- 对手区域 -->
            <div id="playerAreaTop" class="playerArea opponent-area opponent-top" data-player-slot-rel="2"> <!-- 假设对面是相对位置2 -->
                <div class="playerHeader">
                    <div class="player-avatar"></div>
                    <div class="player-details"><span class="playerName"></span><span class="playerRole"></span></div>
                </div>
                <div class="playerInfo"></div>
                <div class="playerCards opponentHand"></div>
            </div>
            <div id="playerAreaLeft" class="playerArea opponent-area opponent-left" data-player-slot-rel="1"> <!-- 假设左边是相对位置1 -->
                <div class="playerHeader">
                    <div class="player-avatar"></div>
                    <div class="player-details"><span class="playerName"></span><span class="playerRole"></span></div>
                </div>
                <div class="playerInfo"></div>
                <div class="playerCards opponentHand"></div>
            </div>
            <div id="playerAreaRight" class="playerArea opponent-area opponent-right" data-player-slot-rel="3"> <!-- 假设右边是相对位置3 (4人局) -->
                <div class="playerHeader">
                    <div class="player-avatar"></div>
                    <div class="player-details"><span class="playerName"></span><span class="playerRole"></span></div>
                </div>
                <div class="playerInfo"></div>
                <div class="playerCards opponentHand"></div>
            </div>

            <!-- 中央区域: 出牌区和上一手牌信息 -->
            <div id="centerArea">
                <div id="centerPileArea">
                    <!-- 打出的牌会显示在这里 -->
                </div>
                <div id="centerInfo">
                    <p id="lastHandText">上一手牌:</p>
                    <span id="lastHandTypeDisplay"></span>
                </div>
            </div>

            <!-- 底部玩家自己区域: 手牌、信息、操作按钮 -->
            <div id="playerAreaBottom" class="playerArea selfArea" data-player-slot-rel="0">
                <div id="myHand" class="playerCards myHand">
                    <!-- 自己的手牌会显示在这里 -->
                </div>
                <div class="self-player-info-container">
                    <div class="playerHeader">
                        <div class="player-avatar"></div> <!-- 自己的头像 -->
                        <div class="player-details">
                            <span class="playerName">你</span>
                            <span class="playerRole">[?]</span>
                        </div>
                    </div>
                    <div class="playerInfo">总分: 0</div> <!-- 自己的信息 -->
                    <button id="readyButton" class="hidden-view">准备</button> <!-- 准备按钮 -->
                </div>
                <div class="my-actions-container hidden-view"> <!-- 游戏中的操作按钮 -->
                    <button id="sortHandButton" title="整理手牌">整理</button>
                    <button id="hintButton" title="获取提示">提示</button>
                    <button id="passTurnButton" title="不出 / 过牌">不要</button>
                    <button id="playSelectedCardsButton" title="打出选择的牌" disabled>出牌</button>
                </div>
            </div>
            
            <!-- 游戏状态/回合提示信息显示 -->
            <div id="gameStatusDisplay">等待玩家...</div>
        </div>

        <!-- 游戏结束遮罩层 -->
        <div id="gameOverOverlay" class="overlay hidden-view view-flex">
             <div class="overlay-content">
                 <h3 id="gameOverTitle">游戏结束!</h3>
                 <p id="gameOverReason"></p>
                 <div id="gameOverScores">
                     <!-- 得分详情会显示在这里 -->
                 </div>
                 <button id="backToLobbyButton">返回大厅</button>
             </div>
         </div>
    </div>

    <!-- Socket.IO 客户端库 -->
    <script src="/socket.io/socket.io.js"></script>
    <!-- 客户端逻辑脚本，建议版本号与 style.css 一致 -->
    <script src="client.js?v=1.1.0"></script>
</body>
</html>
