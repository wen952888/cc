/* public/style.css */
html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #e0e0e0; color: #333; font-size: 16px; -webkit-tap-highlight-color: transparent; }
.hidden-view { display: none !important; } .view-block { display: block !important; } .view-flex { display: flex !important; flex-direction: column; } .overlay.view-flex { justify-content: center; align-items: center; }
.view { background-color: #f5f5f5; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border-radius: 10px; margin: 20px auto; padding: 25px; box-sizing: border-box; }
.view#loginRegisterView, .view#lobbyView, .view#auth-view, .view#loadingView { width: 90%; max-width: 400px; color: #333; }
.view#loadingView.view-block { text-align: center; padding-top: 50px; font-size: 1.2em; color: #555; background-color: transparent; box-shadow: none;}
.view#authFormContainer { display: flex; flex-wrap: wrap; justify-content: space-around; margin-bottom: 20px; gap: 20px; }
.view .formSection { border: none; padding: 20px; border-radius: 8px; width: 100%; max-width: 300px; box-sizing: border-box; background-color: #f0f0f0; }
 .view input[type="text"], .view input[type="password"], .view input[type="tel"] { border: 1px solid #ccc; padding: 10px; border-radius: 4px; margin-bottom: 10px; width: calc(100% - 22px); box-sizing: border-box; font-size: 1em; }
 .view #roomList { border: 1px solid #d8d8d8; background-color: #efefef; padding: 10px; border-radius: 5px; max-height: 300px; overflow-y: auto;}
 .view .room-item { border-bottom: 1px solid #e0e0e0; color: #444; padding: 10px 5px; display: flex; justify-content: space-between; align-items: center;}
 .view .room-item:last-child { border-bottom: none; }
 .view .room-item span { margin-right: 10px; }
 .view .room-item button { font-size: 0.85em; padding: 6px 10px; }
button { padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9em; transition: background-color 0.2s ease; margin: 5px 0; }
button:hover { background-color: #0056b3; }
button:disabled { background-color: #ccc; cursor: not-allowed; color: #666; }
.inline-button { padding: 4px 8px; font-size: 0.8em; margin-left: 8px; }
.message { margin-top: 12px; font-weight: bold; text-align: center; font-size: 0.85em; min-height: 1.1em; padding: 6px; border-radius: 4px; color: #444;}
.message.error { color: #721c24; background-color: #f8d7da; border: 1px solid #f5c6cb; }
.message.success { color: #155724; background-color: #d4edda; border: 1px solid #c3e6cb; }

/* Game View & Room View common parts */
.view#game-view, .view#roomView { width: 100%; max-width: 800px; height: auto; min-height: 400px; padding: 15px; background-color: #f0f0f0; display: flex; flex-direction: column;}
.view#gameArea { flex-grow: 1; position: relative; padding-top: 10px; padding-bottom: 25px; box-sizing: border-box; background-color: #e9e9e9; border-radius: 8px; overflow: hidden; }
.view#gameInfoBar { position: absolute; top: 10px; right: 10px; width: auto; height: auto; padding: 6px 10px; display: flex; flex-direction: row; align-items: center; justify-content: flex-end; background-color: rgba(240, 240, 240, 0.8); border-radius: 5px; box-shadow: 0 1px 2px rgba(0,0,0,0.15); z-index: 300; }
.view#gameInfoBar .room-name-id { font-size: 0.75em; color: #333; margin-right: 12px; white-space: nowrap; }
.view#gameInfoBar .room-name-id .room-name { font-weight: normal; }
.view#gameInfoBar .room-name-id .room-id { opacity: 0.8; margin-left: 4px; }
.view#gameInfoBar #leaveRoomButton { padding: 4px 8px; font-size: 0.75em; background-color: #e57373; color: white; border: none; border-radius: 4px; flex-shrink: 0; }
.playerArea { display: flex; flex-direction: column; align-items: center; text-align: center; padding: 3px; box-sizing: border-box; min-width: 80px; }
.playerHeader { display: flex; flex-direction: column; align-items: center; margin-bottom: 1px; }
.player-avatar { width: 30px; height: 30px; border-radius: 50%; background-color: #d0d0d0; background-size: cover; background-position: center; flex-shrink: 0; border: 1px solid #b0b0b0; display: flex; justify-content: center; align-items: center; margin-bottom: 2px; position: relative;}
.player-avatar img.alarm-icon { width: 20px; height: 20px; }
.player-details { display: flex; flex-direction: column; align-items: center; }
.playerName { font-weight: bold; font-size: 0.75em; color: #333; white-space: nowrap; }
.playerRole { font-size: 0.65em; font-style: italic; color: #555; }
.playerInfo { font-size: 0.6em; line-height: 1.1; color: #666; width: 100%; margin-top: 1px;}
.playerInfo .ready { color: #28a745; font-weight: bold; } .playerInfo .not-ready { color: #ffc107; font-weight: bold;} .playerInfo .disconnected { color: #dc3545; font-style: italic; } .playerInfo .finished { color: #6c757d; font-style: italic; }

.voice-indicator-container { width: 10px; height: 10px; display: flex; align-items: center; justify-content: center; }
.voice-indicator { width: 8px; height: 8px; background-color: #bbb; border-radius: 50%; transition: background-color 0.1s, box-shadow 0.1s; }
.voice-indicator.speaking { background-color: #4CAF50; box-shadow: 0 0 4px #4CAF50, 0 0 8px #4CAF50; }

.opponent-area { position: absolute; z-index: 100; background-color: rgba(255,255,255,0.7); padding: 5px; border-radius: 5px; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
.opponent-area .playerHeader { flex-direction: row; align-items: center; }
.opponent-area .voice-indicator-container { order: -1; margin-right: 4px; }
.opponent-area .player-details { margin-left: 3px; align-items: flex-start; }
#player-top { top: 10px; left: 50%; transform: translateX(-50%);}
#player-left { top: 50%; left: 10px; transform: translateY(-50%); }
#player-right { top: 50%; right: 10px; transform: translateY(-50%); }
.opponent-area .player-name { font-weight: bold; font-size: 0.8em; }
.opponent-area .player-card-count { font-size: 0.7em; }


#micButton { background-color: #6c757d; border: 1px solid #5a6268; color: white; }
#micButton.active { background-color: #28a745; border-color: #1e7e34; }
#micButton:disabled { background-color: #9e9e9e; border-color: #757575; cursor: not-allowed; }

.playerArea.current-turn .player-avatar, .opponent-area.current-turn { box-shadow: 0 0 8px 2px gold, 0 0 12px 3px rgba(255, 215, 0, 0.5); border-color: gold; }
.overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8); z-index: 1000; }
.overlay-content { background-color: #fefefe; padding: 18px; border-radius: 8px; text-align: center; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.22); max-width: 90%; width: 380px; color: #333;}
#gameOverScores p { margin: 5px 0; font-size: 0.95em; }
#gameOverScores .score-plus { color: #28a745; font-weight: bold; }
#gameOverScores .score-minus { color: #dc3545; font-weight: bold; }
#gameOverScores .score-zero { color: #6c757d; }
.hand-count-display { font-size: 0.7em; color: #fff; background-color: rgba(0,0,0,0.7); padding: 1px 4px; border-radius: 6px; z-index: 160; position: absolute; bottom: -6px; left: 50%; transform: translateX(-50%); white-space: nowrap; }

/* Authentication Form Styles */
#auth-view {
 display: flex;
 flex-direction: column; /* Stack forms vertically */
 justify-content: center;
 align-items: center;
 min-height: 80vh; /* Use viewport height */
 background-color: #f0f0f0;
 padding: 20px;
}

#login-form,
#register-form {
 background-color: #fff;
 padding: 25px;
 border-radius: 8px;
 box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
 text-align: center;
 width: 100%;
 max-width: 350px; /* Limit width */
 box-sizing: border-box;
}
#register-form { display: none; } /* Initially hidden */

#login-form h2,
#register-form h2 {
 margin-top: 0;
 margin-bottom: 20px;
 color: #333;
}

#login-form p,
#register-form p {
 margin-top: 15px;
 font-size: 0.9em;
}

#login-form a,
#register-form a {
 color: #007bff;
 text-decoration: none;
 font-weight: bold;
}
#login-form a:hover,
#register-form a:hover { text-decoration: underline; }

/* Lobby View Styles */
#lobby-view {
    padding: 20px;
    max-width: 500px;
    margin: 20px auto;
    background-color: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}
#lobby-view h2 { text-align: center; color: #333; margin-bottom: 20px; }
#createRoomForm { margin-bottom: 20px; padding: 15px; border: 1px solid #eee; border-radius: 4px; background-color: #f9f9f9; display: flex; }
#createRoomForm input[type="text"] { flex-grow: 1; padding: 8px; margin-right: 10px; border: 1px solid #ccc; border-radius: 4px; }
#createRoomForm button { padding: 8px 15px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; white-space: nowrap; }
#createRoomForm button:hover { background-color: #218838; }
#roomList h3 { color: #555; margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
#rooms { list-style: none; padding: 0; margin: 0; }
#rooms li { background-color: #f0f0f0; padding: 10px; margin-bottom: 8px; border-radius: 4px; display: flex; justify-content: space-between; align-items: center; }
#rooms li span { flex-grow: 1; margin-right: 10px; font-size: 0.9em; }
#rooms li button { padding: 5px 10px; background-color: #007bff; font-size: 0.8em; }
#rooms li button:hover { background-color: #0056b3; }


/* Game View Specific Styles */
#game-view h2 { color: #333; margin-bottom: 15px; text-align: center; }
#players-info {
    display: grid;
    grid-template-areas:
        ". player-top ."
        "player-left center-area player-right"
        ". player-bottom ."; /* player-bottom is for self hand, not an opponent usually */
    grid-template-rows: auto 1fr auto;
    grid-template-columns: auto 1fr auto;
    gap: 10px;
    margin-bottom: 15px;
    position: relative; /* For absolute positioning of opponent areas */
    min-height: 150px; /* Space for opponent info */
}

#discarded-cards { margin-bottom: 15px; border: 1px dashed #aaa; padding: 10px; border-radius: 4px; min-height: 110px; background-color: rgba(0,0,0,0.03); display: flex; flex-direction: column; align-items: center;}
#discarded-cards h3 { margin-top: 0; margin-bottom: 5px; color: #444; font-size: 0.9em; }
#discarded-cards-area { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 5px; }
.last-hand-type { font-size: 0.8em; color: #666; margin-bottom: 5px; font-style: italic; }

#player-hand { margin-bottom: 15px; padding: 10px; border-radius: 4px; background-color: rgba(0,0,0,0.02); }
#player-hand h3 { margin-top: 0; margin-bottom: 8px; color: #333; font-size: 1em; text-align: center; }
#player-hand-area {
    display: flex;
    justify-content: center;
    align-items: flex-end; /* Cards sit at the bottom of this area if they have different heights */
    min-height: 120px; /* Ensure space for cards + animation */
    padding-bottom: 10px;
    flex-wrap: wrap; /* Allow cards to wrap if too many */
    perspective: 800px; /* Optional: for 3D effects on cards */
}

#game-controls { margin-top: 15px; text-align: center; padding-bottom: 10px; }
#game-controls button { padding: 10px 18px; margin: 0 8px; font-size: 0.95em; }
#play-button { background-color: #28a745; } #play-button:hover { background-color: #218838; }
#pass-button { background-color: #ffc107; color: #212529; } #pass-button:hover { background-color: #e0a800; }
#hint-button { background-color: #17a2b8; } #hint-button:hover { background-color: #117a8b; }
#backToLobbyBtn { background-color: #6c757d; margin-top: 10px;} #backToLobbyBtn:hover { background-color: #545b62;}


/* Card Styling and Animation */
.card {
    width: 60px; 
    height: 90px;
    background-size: contain; 
    background-repeat: no-repeat;
    background-position: center;
    border: 1px solid #777;
    border-radius: 5px;
    display: inline-block;
    cursor: default;
    box-shadow: 1px 1px 3px rgba(0,0,0,0.2);
    position: relative; 
    background-color: #fff; /* Fallback */
}
.center-pile-card {
    margin: 2px; /* Spacing for cards in the center pile */
}

.my-card.selectable { cursor: pointer; }
.my-card.selected {
    transform: translateY(-12px) scale(1.05); /* Lift and slightly enlarge */
    box-shadow: 0 0 12px 3px #006eff;
    border-color: #006eff;
    z-index: 20; /* Ensure selected card is on top */
}
.my-card.hinted {
    box-shadow: 0 0 12px 4px gold, inset 0 0 0 2px gold; /* Outer and inner glow for hint */
    z-index: 15; /* Above normal cards but below selected */
}

/* Animation styles for cards being dealt into player's hand */
.card.card-in-hand {
    /* Initial state before dealing animation */
    opacity: 0;
    transform: translateY(50px) translateX(-30px) rotate(-20deg) scale(0.6); 
    transition: opacity 0.35s ease-out, transform 0.45s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* cubic-bezier for a bit of bounce */
    margin: 0 -20px; /* Overlap cards. Adjust if card width changes. (width - visible part) / 2. Example: (60 - 20_visible) / 2 = -20px  */
}
.card.card-in-hand:hover:not(.selected) {
    transform: translateY(-5px) scale(1.02); /* Slight lift on hover for non-selected cards */
    z-index: 10; /* Bring to front on hover, below hinted/selected */
}

.card.card-in-hand.dealt {
    /* Final state after dealing animation */
    opacity: 1;
    transform: translateY(0) translateX(0) rotate(0deg) scale(1);
}


@media (max-width: 768px) {
    .card { width: 50px; height: 75px; }
    .card.card-in-hand { margin: 0 -18px; } /* Adjust overlap for smaller cards */
    #player-hand-area { min-height: 95px; }
    #game-controls button { padding: 8px 12px; font-size: 0.9em; margin: 0 5px;}
    .opponent-area { padding: 3px; }
    .opponent-area .player-name { font-size: 0.75em; }
    .opponent-area .player-card-count { font-size: 0.65em; }
}

@media (max-width: 480px) {
    .view#loginRegisterView, .view#lobbyView, .view#auth-view { padding: 15px; }
    .view input[type="text"], .view input[type="password"], .view input[type="tel"] { padding: 8px; font-size: 0.9em; }
    button { padding: 8px 12px; font-size: 0.85em; }
    
    .card { width: 40px; height: 60px; border-radius: 3px; }
    .card.card-in-hand { margin: 0 -15px; } /* Adjust overlap */
     .my-card.selected { transform: translateY(-8px) scale(1.05); }


    #player-hand-area { min-height: 75px; padding-bottom: 5px;}
    #game-controls button { padding: 7px 10px; font-size: 0.8em; margin: 0 3px;}
    #discarded-cards { min-height: 70px; padding: 5px; }
    .opponent-area .player-name { font-size: 0.7em; }
    .opponent-area .player-card-count { font-size: 0.6em; }
    #player-top { top: 5px; }
    #player-left { top: 40%; left: 5px; }
    #player-right { top: 40%; right: 5px; }
}
